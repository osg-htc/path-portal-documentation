
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://portal.path-cc.io/documentation/htc_workloads/containers/containers-docker/">
      
      <link rel="icon" href="../../../assets/PATh_Logo_Round_Color.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>Containers - Docker - PATh Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/code-highlight.css">
    
      <link rel="stylesheet" href="../../../stylesheets/path.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#createregister-a-docker-container-image" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="/" title="PATh Documentation" class="md-header__button md-logo" aria-label="PATh Documentation" data-md-component="logo">
      
  <img src="../../../assets/PATh_Logo_Round_Color_White_Border.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PATh Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Containers - Docker
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../overview/account_setup/getting-started/" class="md-tabs__link">
        Overview
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../support_and_training/support/getting-help-from-RCFs/" class="md-tabs__link">
        Support And Training Resources
      </a>
    </li>
  

  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../submitting_workloads/quickstart/" class="md-tabs__link md-tabs__link--active">
        Managing HTC Workloads On the PATh Facility
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="/" title="PATh Documentation" class="md-nav__button md-logo" aria-label="PATh Documentation" data-md-component="logo">
      
  <img src="../../../assets/PATh_Logo_Round_Color_White_Border.png" alt="logo">

    </a>
    PATh Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Overview" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Welcome
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Welcome" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Welcome
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/account_setup/getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/account_setup/request-credits/" class="md-nav__link">
        Request PATh Facility Credits
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/references/credit-account-charges/" class="md-nav__link">
        Credit Account Charges
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/references/PATh_vs_OSPool/" class="md-nav__link">
        PATh Facility vs. OSG's Open Science Pool
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          Account Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Account Setup" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Account Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/account_setup/registration/" class="md-nav__link">
        Register for a PATh Facility Account
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/account_setup/generate-add-sshkey/" class="md-nav__link">
        Log in with SSH Keys
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Support And Training Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Support And Training Resources" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Support And Training Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Get Help!
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Get Help!" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Get Help!
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../support_and_training/support/getting-help-from-RCFs/" class="md-nav__link">
        Email, Office Hours, and Individual Consultations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Managing HTC Workloads On the PATh Facility
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Managing HTC Workloads On the PATh Facility" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Managing HTC Workloads On the PATh Facility
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Submitting HTC Workloads With HTCondor
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Submitting HTC Workloads With HTCondor" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Submitting HTC Workloads With HTCondor
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../submitting_workloads/quickstart/" class="md-nav__link">
        Quickstart-Submit Example HTCondor Jobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../submitting_workloads/submit-multiple-jobs/" class="md-nav__link">
        Easily Submit Multiple Jobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../submitting_workloads/checkpointing/" class="md-nav__link">
        Checkpointing Jobs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Specific Resource Needs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Specific Resource Needs" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Specific Resource Needs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../specific_resources/gpus/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../specific_resources/large-memory/" class="md-nav__link">
        Large Memory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../specific_resources/multicore/" class="md-nav__link">
        Multicore
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Software
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Software" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Software
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../using_software/conda-environments/" class="md-nav__link">
        Using conda to Run Python on the PATh Facility
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Containers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Containers" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Containers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../containers/" class="md-nav__link">
        Containers - Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../containers-singularity/" class="md-nav__link">
        Containers - Apptainer/Singularity
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Containers - Docker
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Containers - Docker
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#use-an-existing-docker-container" class="md-nav__link">
    Use an Existing Docker Container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-a-docker-container" class="md-nav__link">
    Build a Docker Container
  </a>
  
    <nav class="md-nav" aria-label="Build a Docker Container">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-docker-and-get-a-docker-hub-account" class="md-nav__link">
    Install Docker and Get a Docker Hub Account
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#identify-components" class="md-nav__link">
    Identify Components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-the-image" class="md-nav__link">
    Build the Image
  </a>
  
    <nav class="md-nav" aria-label="Build the Image">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-editing-the-dockerfile" class="md-nav__link">
    Option 1: Editing the Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-editing-the-default-image-using-local-docker" class="md-nav__link">
    Option 2: Editing the default image using local Docker
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upload-docker-container-to-docker-hub" class="md-nav__link">
    Upload Docker Container to Docker Hub
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-cases" class="md-nav__link">
    Special Cases
  </a>
  
    <nav class="md-nav" aria-label="Special Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accessing-cvmfs" class="md-nav__link">
    Accessing CVMFS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entrypoint-and-env" class="md-nav__link">
    ENTRYPOINT and ENV
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../available-containers-list/" class="md-nav__link">
        Containers - Predefined List
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_5">
          Using Data and Job Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Using Data and Job Files" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Using Data and Job Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../using_data/data-transfer/" class="md-nav__link">
        Data Staging and Transfer to Jobs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_6" type="checkbox" id="__nav_4_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_6">
          Automated Workflows
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Automated Workflows" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          Automated Workflows
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../automated_workflows/dagman-workflows/" class="md-nav__link">
        Submit Workflows with HTCondor's DAGMan 
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#use-an-existing-docker-container" class="md-nav__link">
    Use an Existing Docker Container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-a-docker-container" class="md-nav__link">
    Build a Docker Container
  </a>
  
    <nav class="md-nav" aria-label="Build a Docker Container">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-docker-and-get-a-docker-hub-account" class="md-nav__link">
    Install Docker and Get a Docker Hub Account
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#identify-components" class="md-nav__link">
    Identify Components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-the-image" class="md-nav__link">
    Build the Image
  </a>
  
    <nav class="md-nav" aria-label="Build the Image">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-editing-the-dockerfile" class="md-nav__link">
    Option 1: Editing the Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-editing-the-default-image-using-local-docker" class="md-nav__link">
    Option 2: Editing the default image using local Docker
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upload-docker-container-to-docker-hub" class="md-nav__link">
    Upload Docker Container to Docker Hub
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-cases" class="md-nav__link">
    Special Cases
  </a>
  
    <nav class="md-nav" aria-label="Special Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accessing-cvmfs" class="md-nav__link">
    Accessing CVMFS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entrypoint-and-env" class="md-nav__link">
    ENTRYPOINT and ENV
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="createregister-a-docker-container-image">Create/Register a Docker Container Image<a class="headerlink" href="#createregister-a-docker-container-image" title="Permanent link">&para;</a></h1>
<p>This guide is meant to accompany the instructions for using containers 
in the PATh Facility.  You can use your own custom container to run jobs in the 
PATh Facility, and we assume that those containers are built using Docker.  This 
guide describes how to create your own Docker container "image" (the blueprint for 
the container) and how to convert it to a Singularity/Apptainer image. </p>
<p>For an overview and how to execute images in PATh, please see
<a href="../containers">Containers - Overview</a></p>
<h2 id="use-an-existing-docker-container">Use an Existing Docker Container<a class="headerlink" href="#use-an-existing-docker-container" title="Permanent link">&para;</a></h2>
<p>If a Docker container image already exists with the software you need, it can 
be converted to a Singularity/Apptainer image format using this command: </p>
<div class="codehilite"><pre><span></span><code>apptainer build my-custom-image.sif docker://owner/repo:tag
</code></pre></div>

<p>Replace <code>my-custom-image.sif</code> with a name of your choice (keeping the <code>.sif</code> suffix) 
and the <code>docker://owner/repo:tag</code> can be the identifier for any publicly hosted 
Docker image, including those on <code>quay.io</code> and the NVIDIA NGC Catalog <code>nvcr.io</code>. </p>
<p>Once the <code>.sif</code> file is created, you can copy it to a data directory, 
test it on the Access Point,
and use it in your HTCondor jobs as described in
<a href="../containers">Containers - Overview</a>.</p>
<h2 id="build-a-docker-container">Build a Docker Container<a class="headerlink" href="#build-a-docker-container" title="Permanent link">&para;</a></h2>
<h3 id="install-docker-and-get-a-docker-hub-account">Install Docker and Get a Docker Hub Account<a class="headerlink" href="#install-docker-and-get-a-docker-hub-account" title="Permanent link">&para;</a></h3>
<p>You'll need a Docker Hub account in order to download Docker and share your 
Docker container images: <a href="https://hub.docker.com/">DockerHub</a></p>
<p>Install Docker Desktop to your computer using the appropriate version for your 
operating system. Note that PATh does not provide any Docker build hosts.</p>
<h3 id="identify-components">Identify Components<a class="headerlink" href="#identify-components" title="Permanent link">&para;</a></h3>
<p>What software do you want to install? Make sure that you have either the source 
code or a command that can be used to install it through Linux (like <code>apt-get</code> or 
<code>yum</code>). </p>
<p>You'll also need to choose a "base" container, on which to add your particular 
software or tools. 
See the available containers on Docker Hub here: 
<a href="https://hub.docker.com/u/opensciencegrid">OSG Docker Containers</a>
The best candidates for you will be containers that have "osgvo" in the name. </p>
<h3 id="build-the-image">Build the Image<a class="headerlink" href="#build-the-image" title="Permanent link">&para;</a></h3>
<p>There are two ways to build a Docker container image: </p>
<ol>
<li>Edit a <code>Dockerfile</code> and use it to produce an image</li>
<li>Edit a default image using local Docker</li>
</ol>
<p>We recommend the first option, as it is more reproducible, but the second option 
can be useful for troubleshooting or especially tricky installs. </p>
<h4 id="option-1-editing-the-dockerfile">Option 1: Editing the <code>Dockerfile</code><a class="headerlink" href="#option-1-editing-the-dockerfile" title="Permanent link">&para;</a></h4>
<p>Create a folder on your computer and inside it, create a blank text file 
called <code>Dockerfile</code>.  </p>
<p>The first line of this file should include the keyword <code>FROM</code> and then 
the name of a Docker image (from Docker Hub) you want 
to use as your starting point. If using the OSG's Ubuntu Xenial image that 
would look like this: </p>
<div class="codehilite"><pre><span></span><code>FROM opensciencegrid/osgvo-ubuntu-xenial
</code></pre></div>

<p>Then, for each command you want to run to add libraries or software, use the 
keyword <code>RUN</code> and then the command. Sometimes it makes sense to string 
commands together using the <code>&amp;&amp;</code> operator and line breaks <code>\</code>, like so:</p>
<div class="codehilite"><pre><span></span><code>RUN apt-get update &amp;&amp; \
    apt-get install -yy build-essentials
</code></pre></div>

<p>or</p>
<div class="codehilite"><pre><span></span><code>RUN wget https://cran.r-project.org/src/base/R-3/R-3.6.0.tar.gz &amp;&amp; \
    tar -xzf R-3.6.0.tar.gz &amp;&amp; \
    cd R-3.6.0 &amp;&amp; \
    ./configure &amp;&amp; \
    make &amp;&amp; \
    make install
</code></pre></div>

<p>Typically it's good to group together commands installing the same kind of thing 
(system libraries, or software packages, or an installation process) under one <code>RUN</code> command, 
and then have multiple <code>RUN</code> commands, one for each of the different type of 
software or package you're installing. </p>
<p>(For all the possible Dockerfile keywords, see the <a href="https://docs.docker.com/engine/reference/builder/">Docker Documentation</a>)</p>
<p>Once your Dockerfile is ready, you can "build" the container image by running this command: </p>
<div class="codehilite"><pre><span></span><code>$ docker build -t namespace/repository_name .
</code></pre></div>

<p>Note that the naming convention for Docker images is your Docker Hub username and then 
a name you choose for that particular container image. So if my Docker Hub username 
is <code>alice</code> and I created an image with the NCBI <code>blast</code> tool, I might use this name: </p>
<div class="codehilite"><pre><span></span><code>$ docker build -t alice/NCBI-blast .
</code></pre></div>

<h4 id="option-2-editing-the-default-image-using-local-docker">Option 2: Editing the default image using local Docker<a class="headerlink" href="#option-2-editing-the-default-image-using-local-docker" title="Permanent link">&para;</a></h4>
<p>You can also build an image interactively, without a Dockerfile. First, get 
the desired starting image from Docker Hub. Again, we will
look at the OSG Ubuntu Xenial image. </p>
<div class="codehilite"><pre><span></span><code>$ docker pull opensciencegrid/osgvo-ubuntu-xenial
</code></pre></div>

<p>We will run the image in a docker interactive session</p>
<div class="codehilite"><pre><span></span><code>$ docker run -it --name &lt;docker_session_name_here&gt; opensciencegrid/osgvo-ubuntu-xenial /bin/bash
</code></pre></div>

<p>Giving the session a name is important because it will make it easier to 
reattach the session later and commit the changes later on. Now you will 
be greeted by a new command line prompt that will look something like this</p>
<div class="codehilite"><pre><span></span><code>[root@740b9db736a1 /]#
</code></pre></div>

<p>You can now install the software that you need through the default package 
manager, in this case <code>apt-get</code>. </p>
<div class="codehilite"><pre><span></span><code>[root@740b9db736a1 /]# apt-get install build-essentials
</code></pre></div>

<p>Once you have installed all the software, you simply <code>exit</code></p>
<div class="codehilite"><pre><span></span><code>[root@740b9db736a1 /]# exit
</code></pre></div>

<p>Now you can commit the changes to the image and give it a name: </p>
<div class="codehilite"><pre><span></span><code>docker commit &lt;docker_session_name_here&gt; namespace/repository_name
</code></pre></div>

<p>You can also use the session's hash as found in the command prompt (<code>740b9db736a1</code> 
in the above example) in place of the docker session name. </p>
<h3 id="upload-docker-container-to-docker-hub">Upload Docker Container to Docker Hub<a class="headerlink" href="#upload-docker-container-to-docker-hub" title="Permanent link">&para;</a></h3>
<p>Once your container is complete and tagged, it should appear in the list of local Docker 
container images, which you can see by running:</p>
<div class="codehilite"><pre><span></span><code>$ docker images
</code></pre></div>

<p>From there, you need to put it in Docker Hub, which can be done via the <code>docker push</code> 
command:</p>
<div class="codehilite"><pre><span></span><code>$ docker push namespace/repository_name
</code></pre></div>

<p>From here, if you're planning to use this container in OSG, see the 
<a href="#use-an-existing-docker-container">first section of this guide</a>. </p>
<h2 id="special-cases">Special Cases<a class="headerlink" href="#special-cases" title="Permanent link">&para;</a></h2>
<h3 id="accessing-cvmfs">Accessing CVMFS<a class="headerlink" href="#accessing-cvmfs" title="Permanent link">&para;</a></h3>
<p>If you want your jobs to access CVMFS, make sure that you either: </p>
<ol>
<li>Use one of the base containers provided by the Open Science Pool</li>
</ol>
<p>or</p>
<ol>
<li>Add a <code>/cvmfs</code> folder to your container: </li>
<li>If using a Dockerfile, you can do this with the line <code>RUN mkdir /cvmfs</code></li>
<li>If building your container interactively, run <code>$ mkdir -p /cvmfs</code></li>
</ol>
<p>This will enable the container to access 
tools and data published on <code>/cvmfs</code>. </p>
<p>If you do not want <code>/cvmfs</code> mounted 
in the container, please add <code>+SingularityBindCVMFS = False</code> to your job submit file.</p>
<h3 id="entrypoint-and-env">ENTRYPOINT and ENV<a class="headerlink" href="#entrypoint-and-env" title="Permanent link">&para;</a></h3>
<p>Two options that can be used in the Dockerfile to set the environment or 
default command are <code>ENTRYPOINT</code> and <code>ENV</code>. Unfortunately, both of these 
aspects of the Docker container are deleted when it is converted to a 
Singularity image in the Open Science Pool.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../containers-singularity/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Containers - Apptainer/Singularity" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Containers - Apptainer/Singularity
            </div>
          </div>
        </a>
      
      
        
        <a href="../available-containers-list/" class="md-footer__link md-footer__link--next" aria-label="Next: Containers - Predefined List" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Containers - Predefined List
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs"], "search": "../../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
    
  </body>
</html>