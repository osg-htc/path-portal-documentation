
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://portal.path-cc.io/documentation/htc_workloads/using_software/conda-environments/">
      
      <link rel="icon" href="../../../assets/PATh_Logo_Round_Color.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>Using conda to Run Python on the PATh Facility - PATh Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/code-highlight.css">
    
      <link rel="stylesheet" href="../../../stylesheets/path.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#using-conda-to-run-python-on-the-path-facility" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="/" title="PATh Documentation" class="md-header__button md-logo" aria-label="PATh Documentation" data-md-component="logo">
      
  <img src="../../../assets/PATh_Logo_Round_Color_White_Border.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PATh Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Using conda to Run Python on the PATh Facility
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../overview/account_setup/getting-started/" class="md-tabs__link">
        Overview
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../support_and_training/support/getting-help-from-RCFs/" class="md-tabs__link">
        Support And Training Resources
      </a>
    </li>
  

  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../submitting_workloads/quickstart/" class="md-tabs__link md-tabs__link--active">
        Managing HTC Workloads On the PATh Facility
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="/" title="PATh Documentation" class="md-nav__button md-logo" aria-label="PATh Documentation" data-md-component="logo">
      
  <img src="../../../assets/PATh_Logo_Round_Color_White_Border.png" alt="logo">

    </a>
    PATh Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Overview" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Welcome
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Welcome" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Welcome
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/account_setup/getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/account_setup/request-credits/" class="md-nav__link">
        Request PATh Facility Credits
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/references/credit-account-charges/" class="md-nav__link">
        Credit Account Charges
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/references/PATh_vs_OSPool/" class="md-nav__link">
        PATh Facility vs. OSG's Open Science Pool
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          Account Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Account Setup" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Account Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/account_setup/registration/" class="md-nav__link">
        Register for a PATh Facility Account
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../overview/account_setup/generate-add-sshkey/" class="md-nav__link">
        Log in with SSH Keys
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Support And Training Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Support And Training Resources" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Support And Training Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Get Help!
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Get Help!" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Get Help!
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../support_and_training/support/getting-help-from-RCFs/" class="md-nav__link">
        Email, Office Hours, and Individual Consultations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Managing HTC Workloads On the PATh Facility
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Managing HTC Workloads On the PATh Facility" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Managing HTC Workloads On the PATh Facility
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Submitting HTC Workloads With HTCondor
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Submitting HTC Workloads With HTCondor" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Submitting HTC Workloads With HTCondor
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../submitting_workloads/quickstart/" class="md-nav__link">
        Quickstart-Submit Example HTCondor Jobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../submitting_workloads/submit-multiple-jobs/" class="md-nav__link">
        Easily Submit Multiple Jobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../submitting_workloads/checkpointing/" class="md-nav__link">
        Checkpointing Jobs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Specific Resource Needs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Specific Resource Needs" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Specific Resource Needs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../specific_resources/gpus/" class="md-nav__link">
        GPUs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../specific_resources/large-memory/" class="md-nav__link">
        Large Memory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../specific_resources/multicore/" class="md-nav__link">
        Multicore
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Software
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Software" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Software
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Using conda to Run Python on the PATh Facility
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Using conda to Run Python on the PATh Facility
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-miniconda-and-package-for-jobs" class="md-nav__link">
    Install Miniconda and Package for Jobs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-create-a-miniconda-installation" class="md-nav__link">
    1. Create a Miniconda Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-create-a-conda-environment-with-your-packages" class="md-nav__link">
    2. Create a conda "Environment" With Your Packages
  </a>
  
    <nav class="md-nav" aria-label="2. Create a conda "Environment" With Your Packages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#more-about-miniconda" class="md-nav__link">
    More About Miniconda
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-create-software-package" class="md-nav__link">
    3. Create Software Package
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-check-size-of-conda-environment-tar-archive" class="md-nav__link">
    4. Check Size of Conda Environment Tar Archive
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-create-a-job-executable" class="md-nav__link">
    5. Create a Job Executable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-submit-jobs" class="md-nav__link">
    6. Submit Jobs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specifying-exact-dependency-versions" class="md-nav__link">
    Specifying Exact Dependency Versions
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Containers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Containers" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Containers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../containers/containers/" class="md-nav__link">
        Containers - Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../containers/containers-singularity/" class="md-nav__link">
        Containers - Apptainer/Singularity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../containers/containers-docker/" class="md-nav__link">
        Containers - Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../containers/available-containers-list/" class="md-nav__link">
        Containers - Predefined List
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_5" type="checkbox" id="__nav_4_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_5">
          Using Data and Job Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Using Data and Job Files" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_5">
          <span class="md-nav__icon md-icon"></span>
          Using Data and Job Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../using_data/data-transfer/" class="md-nav__link">
        Data Staging and Transfer to Jobs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_6" type="checkbox" id="__nav_4_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_6">
          Automated Workflows
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Automated Workflows" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_6">
          <span class="md-nav__icon md-icon"></span>
          Automated Workflows
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../automated_workflows/dagman-workflows/" class="md-nav__link">
        Submit Workflows with HTCondor's DAGMan 
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-miniconda-and-package-for-jobs" class="md-nav__link">
    Install Miniconda and Package for Jobs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-create-a-miniconda-installation" class="md-nav__link">
    1. Create a Miniconda Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-create-a-conda-environment-with-your-packages" class="md-nav__link">
    2. Create a conda "Environment" With Your Packages
  </a>
  
    <nav class="md-nav" aria-label="2. Create a conda "Environment" With Your Packages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#more-about-miniconda" class="md-nav__link">
    More About Miniconda
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-create-software-package" class="md-nav__link">
    3. Create Software Package
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-check-size-of-conda-environment-tar-archive" class="md-nav__link">
    4. Check Size of Conda Environment Tar Archive
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-create-a-job-executable" class="md-nav__link">
    5. Create a Job Executable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-submit-jobs" class="md-nav__link">
    6. Submit Jobs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specifying-exact-dependency-versions" class="md-nav__link">
    Specifying Exact Dependency Versions
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="using-conda-to-run-python-on-the-path-facility">Using conda to Run Python on the PATh Facility<a class="headerlink" href="#using-conda-to-run-python-on-the-path-facility" title="Permanent link">&para;</a></h1>
<p>The Anaconda/Miniconda distribution of Python is a common tool for installing and managing Python-based software and other tools. </p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>When should you use Miniconda as an installation method in the PATh Facility?
* Your software has specific conda-centric installation instructions.
* The above is true and the software has a lot of dependencies.
* You mainly use Python to do your work.</p>
<p>Notes on terminology:</p>
<ul>
<li><strong>conda</strong> is a Python package manager and package ecosystem that exists in parallel with <code>pip</code> and <a href="https://pypi.org/">PyPI</a>.</li>
<li><strong>Miniconda</strong> is a slim Python distribution, containing the minimum amount of packages necessary for a Python installation that can use conda.</li>
<li><strong>Anaconda</strong> is a pre-built scientific Python distribution based on Miniconda that has many useful scientific packages pre-installed.</li>
</ul>
<p>To create the smallest, most portable Python installation possible, we recommend starting with Miniconda and installing only the packages you actually require.</p>
<p>To use a Miniconda installation on the PATh Facility, create your installation environment on the Access Point and send a zipped version to your jobs.</p>
<h2 id="install-miniconda-and-package-for-jobs">Install Miniconda and Package for Jobs<a class="headerlink" href="#install-miniconda-and-package-for-jobs" title="Permanent link">&para;</a></h2>
<p>This section of the guide goes through the steps needed to create a software installation inside Miniconda and then use a tool called <code>conda pack</code> to package it up for running jobs.</p>
<h2 id="1-create-a-miniconda-installation">1. Create a Miniconda Installation<a class="headerlink" href="#1-create-a-miniconda-installation" title="Permanent link">&para;</a></h2>
<p>On the Access Point, download the latest Linux <a href="https://docs.conda.io/en/latest/miniconda.html">miniconda installer</a> and run it.</p>
<pre class="term"><code>
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
sh Miniconda3-latest-Linux-x86_64.sh
</code></pre>

<p>Accept the license agreement and default options. At the end, you can choose whether or not to “initialize Miniconda3 by running conda init?” The default is no; you would then run the <strong>eval</strong> command listed by the installer to “activate” Miniconda. If you choose “no” you’ll want to save this command so that you can reactivate the Miniconda installation when needed in the future.</p>
<h2 id="2-create-a-conda-environment-with-your-packages">2. Create a conda "Environment" With Your Packages<a class="headerlink" href="#2-create-a-conda-environment-with-your-packages" title="Permanent link">&para;</a></h2>
<p>(If you are using an <code>environment.yml</code> file as described <a href="#specifying-exact-dependency-versions">later</a>, you should instead create the environment from your <code>environment.yml</code> file. If you don’t have an <code>environment.yml</code> file to work with, follow the install instructions in this section. We recommend switching to the <code>environment.yml</code> method of creating environments once you understand the “manual” method presented here.)</p>
<p>Make sure that you’ve activated the base Miniconda environment if you haven’t already. Your prompt should look like this:</p>
<pre class="term"><code>(base)[alice@ap1]$</code></pre>

<p>To create an environment, use the <code>conda create</code> command and then activate the environment:</p>
<pre class="term"><code>(base)[alice@ap1]$ conda create -n env-name
(base)[alice@ap1]$ conda activate env-name
</code></pre>

<p>Then, run the <code>conda install</code> command to install the different packages and software you want to include in the installation. How this should look is often listed in the installation examples for software (e.g. <a href="https://docs.qiime2.org/2020.2/install/native/#install-qiime-2-within-a-conda-environment">Qiime2</a>, <a href="https://pytorch.org/get-started/locally/">Pytorch</a>).</p>
<pre class="term"><code>(env-name)[alice@ap1]$ conda install pkg1 pkg2
</code></pre>

<p>Some Conda packages are only available via specific Conda channels which serve as repositories for hosting and managing packages. If Conda is unable to locate the requested packages using the example above, you may need to have Conda search other channels. More detail are available at <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/concepts/channels.html">https://docs.conda.io/projects/conda/en/latest/user-guide/concepts/channels.html.</a></p>
<p>Packages may also be installed via <code>pip</code>, but you should only do this when there is no <code>conda</code> package available.</p>
<p>Once everything is installed, deactivate the environment to go back to the Miniconda “base” environment.</p>
<pre class="term"><code>(env-name)[alice@ap1]$ conda deactivate
</code></pre>

<blockquote>
<p>For example, if you wanted to create an installation with <code>pandas</code> and <code>matplotlib</code> and &gt; call the environment <code>py-data-sci</code>, you would use this sequence of commands:</p>
<div class="codehilite"><pre><span></span><code>  (base)[alice@ap1]$ conda create -n py-data-sci
  (base)[alice@ap1]$ conda activate py-data-sci
  (py-data-sci)[alice@ap1]$ conda install pandas matplotlib
  (py-data-sci)[alice@ap1]$ conda deactivate
  (base)[alice@ap1]$
</code></pre></div>

<h3 id="more-about-miniconda">More About Miniconda<a class="headerlink" href="#more-about-miniconda" title="Permanent link">&para;</a></h3>
<p>See the <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">official conda documentation</a> for more information on creating and managing environments with <strong>conda</strong>.</p>
</blockquote>
<h2 id="3-create-software-package">3. Create Software Package<a class="headerlink" href="#3-create-software-package" title="Permanent link">&para;</a></h2>
<p>Make sure that your job’s Miniconda environment is created, but deactivated, so that you’re in the “base” Miniconda environment:</p>
<pre class="term"><code>(base)[alice@ap1]$ </code></pre>

<p>Then, run this command to install the <code>conda pack</code> tool:</p>
<pre class="term"><code>conda install -c conda-forge conda-pack
</code></pre>

<p>Enter <code>y</code> when it asks you to install.</p>
<p>Finally, use <code>conda pack</code> to create a zipped tar.gz file of your environment (substitute the name of your conda environment where you see <code>env-name</code>), set the proper permissions for this file using <code>chmod</code>, and check the size of the final tarball:</p>
<pre class="term"><code>
conda pack -n env-name
chmod 644 env-name.tar.gz
ls -sh env-name.tar.gz
</code></pre>

<p>When this step finishes, you should see a file in your current directory named <code>env-name.tar.gz</code>.</p>
<h2 id="4-check-size-of-conda-environment-tar-archive">4. Check Size of Conda Environment Tar Archive<a class="headerlink" href="#4-check-size-of-conda-environment-tar-archive" title="Permanent link">&para;</a></h2>
<p>The tar archive, <code>env-name.tar.gz</code>, created in the previous step will be used as input for subsequent job submission. As with all job input files, you should check the size of this Conda environment file. <strong>If &gt;100MB in size, you should NOT transfer the tar ball using <code>transfer_input_files</code> from your home directory</strong>. Instead, you should plan to use the 
<code>/path-facility/data/$USER</code> folder, and a <code>stash:///</code> link. </p>
<!--as described in [this guide](../../../htc_workloads/managing_data/stashcache/). Please contact a research computing facilitator at support@osg-htc.org if you have questions about the best option for your jobs.

More information is available at [File Availability with Squid Web Proxy](../../../htc_workloads/using_software/requirements/) and [Managing Large Data in HTC Jobs](../../../htc_workloads/managing_data/osgconnect-storage/).
-->

<h2 id="5-create-a-job-executable">5. Create a Job Executable<a class="headerlink" href="#5-create-a-job-executable" title="Permanent link">&para;</a></h2>
<p>The job will need to go through a few steps to use this “packed” conda environment; first, setting the <code>PATH</code>, then unzipping the environment, then activating it, and finally running whatever program you like. The script below is an example of what is needed (customize as indicated to match your choices above).</p>
<pre class="file"><code>#!/bin/bash

# have job exit if any command returns with non-zero exit status (aka failure)
set -e

# replace env-name on the right hand side of this line with the name of your conda environment
ENVNAME=env-name

# if you need the environment directory to be named something other than the environment name, change this line
ENVDIR=$ENVNAME

# these lines handle setting up the environment; you shouldn't have to modify them
export PATH
mkdir $ENVDIR
tar -xzf $ENVNAME.tar.gz -C $ENVDIR
. $ENVDIR/bin/activate

# modify this line to run your desired Python script and any other work you need to do
python3 hello.py
</code></pre>

<h2 id="6-submit-jobs">6. Submit Jobs<a class="headerlink" href="#6-submit-jobs" title="Permanent link">&para;</a></h2>
<p>In your submit file, make sure to have the following:</p>
<ul>
<li>Your executable should be the the bash script you created in <a href="#5-create-a-job-executable">step 5</a>.</li>
<li>Remember to transfer your Python script and the environment <code>tar.gz</code> file to the job. If the <code>tar.gz</code> file is larger than 100MB, please use the <code>stash:///</code> file delivery mechanism as described above. </li>
</ul>
<h2 id="specifying-exact-dependency-versions">Specifying Exact Dependency Versions<a class="headerlink" href="#specifying-exact-dependency-versions" title="Permanent link">&para;</a></h2>
<p>An important part of improving reproducibility and consistency between runs is to ensure that you use the correct/expected versions of your dependencies.</p>
<p>When you run a command like <code>conda install numpy</code> <code>conda</code> tries to install the most recent version of <code>numpy</code> For example, <code>numpy</code> version <code>1.22.3</code> was released on Mar 7, 2022. To install exactly this version of numpy, you would run <code>conda install numpy=1.22.3</code> (the same works for <code>pip</code> if you replace <code>=</code> with <code>==</code>). We recommend installing with an explicit version to make sure you have exactly the version of a package that you want. This is often called “pinning” or “locking” the version of the package.</p>
<p>If you want a record of what is installed in your environment, or want to reproduce your environment on another computer, conda can create a file, usually called <code>environment.yml</code>, that describes the exact versions of all of the packages you have installed in an environment. This file can be re-used by a different conda command to recreate that exact environment on another computer.</p>
<p>To create an <code>environment.yml</code> file from your currently-activated environment, run</p>
<pre class="term"><code>conda env export > environment.yml</code></pre>

<p>This <code>environment.yml</code> will pin the exact version of every dependency in your environment. This can sometimes be problematic if you are moving between platforms because a package version may not be available on some other platform, causing an “unsatisfiable dependency” or “inconsistent environment” error. A much less strict pinning is</p>
<pre class="term"><code>conda env export --from-history > environment.yml</code></pre>

<p>which only lists packages that you installed manually, and <strong>does not pin their versions unless you yourself pinned them during installation</strong>. If you need an intermediate solution, it is also possible to manually edit <code>environment.yml</code> files; see the <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#">conda environment documentation</a> for more details about the format and what is possible. In general, exact environment specifications are simply not guaranteed to be transferable between platforms (e.g., between Windows and Linux). <strong>We strongly recommend using the strictest possible pinning available to you</strong>.</p>
<p>To create an environment from an <code>environment.yml</code> file, run</p>
<pre class="term"><code>conda env create -f environment.yml</code></pre>

<p>By default, the name of the environment will be whatever the name of the source environment was; you can change the name by adding a <code>-n \&lt;name&gt;</code> option to the <code>conda env create</code> command.</p>
<p>If you use a source control system like <code>git</code>, we recommend checking your <code>environment.yml</code> file into source control and making sure to recreate it when you make changes to your environment. Putting your environment under source control gives you a way to track how it changes along with your own code.</p>
<p>If you are developing software on your local computer for eventual use on the Open Science pool, your workflow might look like this:</p>
<ol>
<li>Set up a conda environment for local development and install packages as desired (e.g., <code>conda create -n science; conda activate science; conda install numpy</code>).</li>
<li>Once you are ready to run on the Open Science pool, create an <code>environment.yml</code> file from your local environment (e.g., <code>conda env export &gt; environment.yml</code>).</li>
<li>Move your <code>environment.yml</code> file from your local computer to the submit machine and create an environment from it (e.g., <code>conda env create -f environment.yml</code>), then pack it for use in your jobs, as per <a href="#3-create-software-package">Create Software Package</a>.
More information on conda environments can be found in <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#">their documentation</a>.</li>
</ol>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../specific_resources/multicore/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Multicore" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Multicore
            </div>
          </div>
        </a>
      
      
        
        <a href="../../containers/containers/" class="md-footer__link md-footer__link--next" aria-label="Next: Containers - Overview" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Containers - Overview
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs"], "search": "../../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
    
  </body>
</html>